<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Detail desain interior - Lihat spesifikasi lengkap, galeri foto, dan informasi harga desain interior pilihan Anda.">
    <title>Detail Desain - Daiku Interior Pekanbaru</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center w-100">
                <a href="index.html" class="navbar-brand">
                    <img src="images/image.png" alt="Daiku Interior & Eksterior" height="24">
                </a>
                
                <ul class="navbar-nav d-lg-flex">
                    <li><a href="index.html" class="nav-link">Beranda</a></li>
                    <li><a href="catalog.html" class="nav-link">Katalog</a></li>
                    <li><a href="rfq-form.html" class="nav-link">Konsultasi</a></li>
                    <li><a href="#" class="nav-link login-required" style="display: none;" onclick="DaikuApp.goToDashboard(); return false;">Pesanan Saya</a></li>
                    <li class="guest-only"><a href="auth.html" class="nav-link">Login</a></li>
                    <li class="login-required dropdown" style="display: none;">
                        <a href="#" class="nav-link dropdown-toggle user-profile">
                            <img src="" alt="Profile" class="rounded-circle me-2" width="24" height="24">
                            <span class="user-name"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="customer-only"><a href="#" class="dropdown-item" onclick="DaikuApp.goToDashboard(); return false;">Dashboard</a></li>
                            <li class="admin-only" style="display: none;"><a href="admin-dashboard.html" class="dropdown-item">Admin Panel</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a href="#" class="dropdown-item" onclick="DaikuApp.logout()">Logout</a></li>
                        </ul>
                    </li>
                </ul>
                
                <button class="mobile-menu-toggle d-lg-none">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Design Detail Content -->
    <div class="design-detail-page py-4">
        <div class="container">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Beranda</a></li>
                    <li class="breadcrumb-item"><a href="catalog.html">Katalog</a></li>
                    <li class="breadcrumb-item active" id="breadcrumbTitle">Detail Desain</li>
                </ol>
            </nav>

            <!-- Design Detail Content -->
            <div id="designDetailContent">
                <!-- Content will be loaded dynamically -->
            </div>

            <!-- Related Designs -->
            <section class="related-designs mt-5">
                <h3 class="mb-4">Desain Serupa</h3>
                <div id="relatedDesigns" class="row">
                    <!-- Related designs will be loaded here -->
                </div>
            </section>
        </div>
    </div>

    <!-- Image Lightbox Modal -->
    <div class="modal fade" id="lightboxModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content bg-dark">
                <div class="modal-header border-0">
                    <button type="button" class="btn-close btn-close-white" data-modal-close></button>
                </div>
                <div class="modal-body text-center p-0">
                    <img id="lightboxImage" src="" alt="" class="img-fluid">
                </div>
                <div class="modal-footer border-0 justify-content-center">
                    <div class="lightbox-controls">
                        <button class="btn btn-outline-light me-2" id="prevImage">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="imageCounter" class="text-white mx-3">1 / 3</span>
                        <button class="btn btn-outline-light ms-2" id="nextImage">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4">
                    <h5 class="mb-3">
                        <i class="fas fa-home me-2"></i>Daiku Interior
                    </h5>
                    <p class="text-muted">
                        Jasa desain interior profesional di Pekanbaru. 
                        Menghadirkan solusi desain terbaik untuk hunian dan bisnis Anda.
                    </p>
                </div>
                
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="mb-3">Menu</h6>
                    <ul class="list-unstyled">
                        <li><a href="index.html" class="text-muted">Beranda</a></li>
                        <li><a href="catalog.html" class="text-muted">Katalog</a></li>
                        <li><a href="index.html#services" class="text-muted">Layanan</a></li>
                        <li><a href="index.html#testimonials" class="text-muted">Testimoni</a></li>
                    </ul>
                </div>
                
                <div class="col-lg-3 col-md-6 mb-4">
                    <h6 class="mb-3">Kontak</h6>
                    <div class="contact-info">
                        <div class="mb-2">
                            <i class="fas fa-map-marker-alt me-2"></i>
                            Jl. Sudirman No. 123, Pekanbaru, Riau
                        </div>
                        <div class="mb-2">
                            <i class="fas fa-phone me-2"></i>
                            <a href="tel:+6281234567890" class="text-muted">+62 812-3456-7890</a>
                        </div>
                        <div class="mb-2">
                            <i class="fas fa-envelope me-2"></i>
                            <a href="mailto:info@daikuinterior.com" class="text-muted">info@daikuinterior.com</a>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6 mb-4">
                    <h6 class="mb-3">Ikuti Kami</h6>
                    <div class="social-links">
                        <a href="#" class="text-white me-3"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-whatsapp"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            
            <hr class="my-4">
            
            <div class="text-center">
                <p class="mb-0 text-muted">
                    &copy; 2024 Daiku Interior Pekanbaru. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="js/data.js"></script>
    <script src="js/main.js"></script>
    <script>
        class DesignDetailManager {
            constructor() {
                this.designId = null;
                this.design = null;
                this.currentImageIndex = 0;
                this.gallery = [];
            }

            init() {
                this.getDesignId();
                this.loadDesign();
                this.bindEvents();
            }

            getDesignId() {
                const urlParams = new URLSearchParams(window.location.search);
                this.designId = parseInt(urlParams.get('id'));
                
                if (!this.designId) {
                    this.showError('Design ID tidak ditemukan');
                    return;
                }
            }

            loadDesign() {
                const designs = StorageManager.getData('designs', []);
                this.design = designs.find(d => d.id === this.designId);
                
                if (!this.design) {
                    this.showError('Desain tidak ditemukan');
                    return;
                }

                this.renderDesignDetail();
                this.loadRelatedDesigns();
                this.updateBreadcrumb();
            }

            renderDesignDetail() {
                const content = document.getElementById('designDetailContent');
                this.gallery = this.design.gallery || [this.design.image];
                
                content.innerHTML = `
                    <div class="row">
                        <!-- Image Gallery -->
                        <div class="col-lg-8">
                            <div class="design-gallery mb-4">
                                <div class="main-image mb-3">
                                    <img id="mainImage" src="${this.gallery[0]}" 
                                         alt="${this.design.title}" 
                                         class="img-fluid rounded-lg shadow cursor-pointer"
                                         onclick="designDetail.openLightbox(0)">
                                </div>
                                <div class="thumbnail-gallery">
                                    <div class="row">
                                        ${this.gallery.map((img, index) => `
                                            <div class="col-4 col-md-3 mb-2">
                                                <img src="${img}" 
                                                     alt="Thumbnail ${index + 1}" 
                                                     class="img-fluid rounded cursor-pointer thumbnail ${index === 0 ? 'active' : ''}"
                                                     onclick="designDetail.changeMainImage(${index})">
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Design Info -->
                        <div class="col-lg-4">
                            <div class="design-info sticky-top" style="top: 100px;">
                                <div class="card">
                                    <div class="card-body">
                                        <h1 class="h3 mb-3">${this.design.title}</h1>
                                        
                                        <div class="design-meta mb-4">
                                            <div class="row">
                                                <div class="col-6">
                                                    <small class="text-muted">Kategori</small>
                                                    <div class="font-weight-medium">${this.design.category}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="text-muted">Gaya</small>
                                                    <div class="font-weight-medium">${this.design.style}</div>
                                                </div>
                                            </div>
                                        </div>

                                        ${this.design.rating ? `
                                            <div class="rating mb-3">
                                                <div class="d-flex align-items-center">
                                                    <div class="stars me-2">
                                                        ${'<i class="fas fa-star text-warning"></i>'.repeat(Math.floor(this.design.rating))}
                                                        ${this.design.rating % 1 !== 0 ? '<i class="fas fa-star-half-alt text-warning"></i>' : ''}
                                                    </div>
                                                    <span class="font-weight-medium">${this.design.rating}</span>
                                                    <span class="text-muted ms-2">(${this.design.reviews || 0} reviews)</span>
                                                </div>
                                            </div>
                                        ` : ''}

                                        <div class="price-info mb-4">
                                            <div class="price-main text-accent h4 font-weight-bold">
                                                ${Utils.formatCurrency(this.design.price)}
                                            </div>
                                            <div class="price-per-m2 text-muted">
                                                ${Utils.formatCurrency(this.design.pricePerM2)} per m²
                                            </div>
                                        </div>

                                        <div class="description mb-4">
                                            <h6>Deskripsi</h6>
                                            <p class="text-muted">${this.design.description}</p>
                                        </div>

                                        ${this.design.tags ? `
                                            <div class="tags mb-4">
                                                <h6>Tags</h6>
                                                <div class="d-flex flex-wrap gap-2">
                                                    ${this.design.tags.map(tag => `
                                                        <span class="badge badge-light">#${tag}</span>
                                                    `).join('')}
                                                </div>
                                            </div>
                                        ` : ''}

                                        <div class="designer-info mb-4 p-3 bg-light rounded">
                                            <h6 class="mb-2">
                                                <i class="fas fa-user-tie me-2"></i>Desainer
                                            </h6>
                                            <div class="font-weight-medium">${this.design.designer}</div>
                                            ${this.design.completed ? 
                                                '<small class="text-success"><i class="fas fa-check-circle me-1"></i>Project Completed</small>' :
                                                '<small class="text-warning"><i class="fas fa-clock me-1"></i>In Progress</small>'
                                            }
                                        </div>

                                        <div class="action-buttons d-grid gap-2">
                                            <a href="rfq-form.html?design=${this.design.id}" class="btn btn-accent btn-lg">
                                                <i class="fas fa-shopping-cart me-2"></i>Pesan Sekarang
                                            </a>
                                            <a href="https://wa.me/6281234567890?text=Halo, saya tertarik dengan desain ${encodeURIComponent(this.design.title)}" 
                                               class="btn btn-outline-success" target="_blank">
                                                <i class="fab fa-whatsapp me-2"></i>Chat WhatsApp
                                            </a>
                                            <button class="btn btn-outline-primary" onclick="designDetail.shareDesign()">
                                                <i class="fas fa-share me-2"></i>Share
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Specifications -->
                    <div class="row mt-5">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">
                                        <i class="fas fa-info-circle me-2"></i>Spesifikasi Detail
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>Informasi Umum</h6>
                                            <table class="table table-borderless">
                                                <tr>
                                                    <td class="text-muted">Luas Area:</td>
                                                    <td class="font-weight-medium">${this.design.specifications.area}</td>
                                                </tr>
                                                <tr>
                                                    <td class="text-muted">Durasi Pengerjaan:</td>
                                                    <td class="font-weight-medium">${this.design.specifications.duration}</td>
                                                </tr>
                                                <tr>
                                                    <td class="text-muted">Status:</td>
                                                    <td>
                                                        ${this.design.completed ? 
                                                            '<span class="badge badge-success">Completed</span>' :
                                                            '<span class="badge badge-warning">In Progress</span>'
                                                        }
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>Material & Warna</h6>
                                            <div class="mb-3">
                                                <small class="text-muted">Material Utama:</small>
                                                <ul class="list-unstyled">
                                                    ${this.design.specifications.materials.map(material => `
                                                        <li><i class="fas fa-check text-success me-2"></i>${material}</li>
                                                    `).join('')}
                                                </ul>
                                            </div>
                                            <div>
                                                <small class="text-muted">Palet Warna:</small>
                                                <div class="d-flex flex-wrap gap-2 mt-1">
                                                    ${this.design.specifications.colors.map(color => `
                                                        <span class="badge badge-light">${color}</span>
                                                    `).join('')}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            loadRelatedDesigns() {
                const designs = StorageManager.getData('designs', []);
                const related = designs
                    .filter(d => d.id !== this.design.id && 
                            (d.category === this.design.category || d.style === this.design.style))
                    .slice(0, 3);

                const container = document.getElementById('relatedDesigns');
                
                if (related.length === 0) {
                    container.innerHTML = '<div class="col-12"><p class="text-muted">Tidak ada desain serupa ditemukan.</p></div>';
                    return;
                }

                container.innerHTML = related.map(design => `
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="card h-100">
                            <img src="${design.image}" class="card-img-top" alt="${design.title}" style="height: 200px; object-fit: cover;">
                            <div class="card-body">
                                <h6 class="card-title">${design.title}</h6>
                                <p class="card-text text-muted small">${design.description.substring(0, 100)}...</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="text-accent font-weight-bold">${Utils.formatCurrency(design.price)}</span>
                                    <a href="design-detail.html?id=${design.id}" class="btn btn-outline-primary btn-sm">
                                        Lihat Detail
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            updateBreadcrumb() {
                document.getElementById('breadcrumbTitle').textContent = this.design.title;
                document.title = `${this.design.title} - Daiku Interior Pekanbaru`;
            }

            bindEvents() {
                // Lightbox events
                document.getElementById('prevImage').addEventListener('click', () => {
                    this.previousImage();
                });

                document.getElementById('nextImage').addEventListener('click', () => {
                    this.nextImage();
                });

                // Keyboard navigation for lightbox
                document.addEventListener('keydown', (e) => {
                    const modal = document.getElementById('lightboxModal');
                    if (modal.classList.contains('show')) {
                        if (e.key === 'ArrowLeft') this.previousImage();
                        if (e.key === 'ArrowRight') this.nextImage();
                    }
                });
            }

            changeMainImage(index) {
                document.getElementById('mainImage').src = this.gallery[index];
                
                // Update thumbnail active state
                document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
                    thumb.classList.toggle('active', i === index);
                });
            }

            openLightbox(index) {
                this.currentImageIndex = index;
                document.getElementById('lightboxImage').src = this.gallery[index];
                this.updateImageCounter();
                DaikuApp.showModal('lightboxModal');
            }

            previousImage() {
                this.currentImageIndex = (this.currentImageIndex - 1 + this.gallery.length) % this.gallery.length;
                document.getElementById('lightboxImage').src = this.gallery[this.currentImageIndex];
                this.updateImageCounter();
            }

            nextImage() {
                this.currentImageIndex = (this.currentImageIndex + 1) % this.gallery.length;
                document.getElementById('lightboxImage').src = this.gallery[this.currentImageIndex];
                this.updateImageCounter();
            }

            updateImageCounter() {
                document.getElementById('imageCounter').textContent = 
                    `${this.currentImageIndex + 1} / ${this.gallery.length}`;
            }

            shareDesign() {
                if (navigator.share) {
                    navigator.share({
                        title: this.design.title,
                        text: this.design.description,
                        url: window.location.href
                    });
                } else {
                    // Fallback: copy URL to clipboard
                    DaikuApp.copyToClipboard(window.location.href);
                }
            }

            showError(message) {
                document.getElementById('designDetailContent').innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                        <h4>Oops! Terjadi Kesalahan</h4>
                        <p class="text-muted">${message}</p>
                        <a href="catalog.html" class="btn btn-primary">Kembali ke Katalog</a>
                    </div>
                `;
            }
        }

        // Initialize design detail page
        const designDetail = new DesignDetailManager();
        document.addEventListener('DOMContentLoaded', function() {
            designDetail.init();
        });
    </script>

    <style>
        .design-gallery .thumbnail {
            transition: all 0.3s ease;
            opacity: 0.7;
            border: 2px solid transparent;
        }
        
        .design-gallery .thumbnail:hover,
        .design-gallery .thumbnail.active {
            opacity: 1;
            border-color: var(--secondary-color);
        }
        
        .cursor-pointer {
            cursor: pointer;
        }
        
        .price-main {
            font-size: 1.5rem;
        }
        
        .stars i {
            font-size: 0.9rem;
        }
        
        .lightbox-controls {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .designer-info {
            border-left: 4px solid var(--secondary-color);
        }
        
        .table td {
            padding: 0.5rem 0;
        }
        
        @media (max-width: 767.98px) {
            .design-info .sticky-top {
                position: static !important;
            }
            
            .thumbnail-gallery .col-4 {
                flex: 0 0 33.333333%;
                max-width: 33.333333%;
            }
        }
    </style>
</body>
</html>